# libp2p-introspection-ui

User interface for visualising libp2p introspection data.

## Setup

To get started locally, clone the repo, and run `yarn install`.

### Running the Catalogue

Run `npm run start:catalogue` to run a dev build of the `catalogue` package, containing a UI for browsing built-in React widgets and connecting these to a data file upload, a websocket to a live LibP2P node, or to provided sample data sets. When the UI is loaded, several options are available to load data:

### Sample data

Pre-made data samples are provided to show how the UI works. They can be loaded using the `Sample data` button and selecting one of the datasets.

### Upload a file

Just like the pre-made samples, it's possible to upload your own dataset. Compatible datasets can be exported using the ui's "Export data" button, and mock data files can be generated using the command `npm run mock-file` with optional flags below.

### Live connection

To get live introspection data streaming into the UI, it's possible to make a websocket connection to a live LibP2P node. 

 - A mock data server can be started using the command `npm run mock-sock` with optional flags below. The predefined url `ws://127.0.0.1:8080/` can be used to connect. 
 - To connect to real live LibP2P data, find the port on which the `introspect` server is running and connect to that appending `/introspect`. For example, if it runs locally on port 12345, connect to `ws://localhost:12345/introspect`.

## Mock server

To run your own mock server that randomly generates data, start it from the `samples` folder using `npm run mock-sock`.

## REPL

A simple way to connect to real LibP2P activity is using the [LibP2P REPL](https://github.com/libp2p/repl):

 1. Clone https://github.com/libp2p/repl and follow its setup instructions
 2. Find and copy the REPL's listening port by:choosing "My Info" in the REPL CLI then finding the listed "Introspection server Listen Address"
 3. Generate some activity using the REPL CLI. The option "DHT: Bootstrap (public seeds)" generates a lot of connection and DHT activity.
 4. In the catalogue UI, connect to the websocket address copied earlier, appending `/introspect`. For example, if My Info gave a listening address of 127.0.0.1/12345, connect to `ws://127.0.0.1:12345/introspect`




- [**`packages/sdk`**](tree/master/packages/sdk): _Status: needs extending, more data structures, more base components including chart types and more input elements, and design improvements needed to the Timeline_. A Software Development Kit for building React components that consume and visualise LibP2P introspection data:
  - [`/components`](tree/master/packages/sdk/components): Base components which can be built on and extended. [**SDK components documentation**](docs/sdk/components/index.md)
  - [`/hooks`](tree/master/packages/sdk/hooks): Custom React Hooks for managing, formatting and manipulating LibP2P introspection data ready for consumption by components. [**SDK hooks documentation**](docs/sdk/hooks/index.md)
  - [`DataProvider`](tree/master/packages/sdk/components/DataProvider) contexts using [`useContext`](https://reactjs.org/docs/hooks-reference.html#usecontext) allowing data and user choices to be cleanly shared between components
  - Theming using [`styled-components`](https://github.com/styled-components/styled-components) and a `useContext` [`ThemeProvider`](tree/master/packages/sdk/components/DataProvider) allowing new components to easily share consistent styling

- [**`packages/proto`**](tree/master/packages/proto): _Status: mostly complete, needing testing and tweaks_. NodeJS scripts for working with LibP2P introspection data in [`protobuf` (Protocol Buffer)](https://developers.google.com/protocol-buffers) format:
  - [`/mock`](tree/master/packages/proto/mock): Scripts for simulating a LibP2P network, generating data files representing plausible network activity observed by a mock LibP2P node.
  - [`/protobuf`](tree/master/packages/proto/protobuf): Original `.proto` protobuf definition, with JavaScript parser and encoder generated by `protoc`.
  - [`/utils`](tree/master/packages/proto/utils) including helper functions and definitions to ease working with decoded LibP2P introspection data in JavaScript


And several example components built on the SDK:

- [**`packages/connections-table`**](tree/master/packages/connections-table) _Status: needs design improvements and additional features including filtering, sparklines and streams subtable_. An interactive data table showing the connections observed at a user-selected point in time, including cumulative traffic, peer Ids, connection status and transports.
- Streams visualisation TBC
- DHT visualisation TBC
- Additional visualisation TBC
- [**`packages/streams-table`**](tree/master/packages/streams-table) A very basic streams datatable added to demonstrate switching between visualizations in the catalogue.
